<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pixel GIF Booth</title>

  <!-- Pixel font -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="style.css">

  <!-- gif.js (client-side GIF encoder) -->
  <script src="https://unpkg.com/gif.js.optimized/dist/gif.js"></script>
</head>
<body>

  <!-- Liquid Glass Distortion Filter -->
  <svg width="0" height="0" style="position:absolute">
    <filter id="glass-distortion" x="-15%" y="-15%" width="130%" height="130%" filterUnits="objectBoundingBox">
      <feTurbulence type="turbulence" baseFrequency="0.003" numOctaves="2" seed="3" result="noise"/>
      <feDisplacementMap in="SourceGraphic" in2="noise" scale="12" xChannelSelector="R" yChannelSelector="G"/>
    </filter>
  </svg>

  <div class="wrap">
    <h1>MaiMaiExpress</h1>

    <div class="bar">
      <div class="pill">âœ¨ Upload or snap 10â€“20 pics â†’ weâ€™ll GIF it!</div>
      <div class="pill">ğŸ“¤ Download or Share to apps</div>
    </div>

    <div class="card">
      <div class="tabbar">
        <button class="btn" id="tab-upload">ğŸ“ Upload</button>
        <button class="btn secondary" id="tab-camera">ğŸ“· Camera</button>
      </div>

      <!-- UPLOAD -->
      <section id="upload-section">
        <div class="row">
          <label>
            <div class="tag">Choose images (10â€“20)</div>
            <small>Drag & drop or use the button. Weâ€™ll scale to a square so your GIF loops nicely.</small>
            <div id="drop" class="drop">Drop images here<br><br>
              <label class="btn" style="display:inline-block;cursor:pointer">
                Select files<input id="file-input" type="file" accept="image/*" multiple>
              </label>
            </div>
          </label>

          <label>
            Frame
            <div id="upload-frame-chooser" class="frame-chooser"></div>
            <small>Pick a frame overlay (optional). It will be baked into the GIF.</small>
          </label>

          <div>
            <label>
              GIF size
              <select id="gif-size">
                <option value="256">256Ã—256</option>
                <option value="320" selected>320Ã—320</option>
                <option value="512">512Ã—512</option>
              </select>
            </label>
            <label>
              Frame delay (ms)
              <input id="upload-delay" type="number" min="20" max="1000" step="10" value="120">
              <small>Lower = faster animation.</small>
            </label>
            <label class="flex">
              <input id="mirror-preview" type="checkbox" checked>
              Mirror preview
            </label>
            <button id="make-gif-upload" class="btn" disabled>ğŸª„ Make GIF</button>
            <div class="status" id="upload-status"></div>
          </div>
        </div>
        <div class="grid" id="upload-grid"></div>
      </section>

      <!-- CAMERA -->
      <section id="camera-section" style="display:none">
        <div class="row">
          <div>
            <div class="camera-wrap">
              <video id="video" playsinline autoplay muted></video>
              <div class="countdown" id="countdown" aria-live="polite"></div>
              <!-- live frame overlay (preview only) -->
              <div class="frame-preview" aria-hidden="true">
                <img id="frame-preview" alt="">
              </div>
            </div>
            <div class="hint" style="margin-top:8px">
              ğŸ’¡ Note: The live preview is mirrored for convenience (like a selfie). The final GIF will not be mirrored.
            </div>
          </div>

          <div>
            <label>
              Number of photos (10â€“20)
              <input id="shot-count" type="number" min="10" max="20" value="20">
            </label>
            <label>
              Seconds between photos
              <input id="interval-secs" type="number" min="1" max="5" value="2">
            </label>
            <label>
              Countdown per shot (seconds)
              <input id="precount-secs" type="number" min="1" max="3" value="3">
            </label>
            <label>
              Frame delay in final GIF (ms)
              <input id="camera-delay" type="number" min="20" max="1000" step="10" value="120">
            </label>
            <label>
              GIF size
              <select id="gif-size-camera">
                <option value="256">256Ã—256</option>
                <option value="320" selected>320Ã—320</option>
                <option value="512">512Ã—512</option>
              </select>
            </label>
            <label>
              Frame
              <div id="frame-chooser" class="frame-chooser"></div>
              <small>Pick a frame overlay (optional). It will be baked into the GIF.</small>
            </label>

            <div class="flex">
              <button id="start-camera" class="btn">ğŸ¬ Start Capture</button>
              <button id="stop-camera" class="btn danger" disabled>ğŸ›‘ Stop</button>
            </div>
            <div class="status" id="camera-status"></div>
          </div>
        </div>
      </section>
    </div>

    <!-- BUILD PROGRESS -->
    <div class="card" style="margin-top:14px">
      <div class="row">
        <div>
          <div class="tag">Build progress</div>
          <div class="progress" aria-label="Progress"><div id="bar"></div></div>
          <div class="status" id="progress-status" style="margin-top:8px"></div>
        </div>
        <div class="result" id="result"></div>
      </div>

      <div class="row" id="share-row" style="display:none">
        <div class="flex">
          <button id="download" class="btn">â¬‡ï¸ Download GIF</button>
          <button id="share" class="btn secondary">ğŸ“¤ Shareâ€¦</button>
          <button id="copygif" class="btn secondary">ğŸ“‹ Copy GIF</button>
          <a id="open-tab" class="btn" href="#" target="_blank" rel="noopener">ğŸªŸ Open in new tab</a>
        </div>
        <div class="hint">
          â€¢ Discord: drag the GIF into a chat (or use Share on mobile).<br>
          â€¢ Instagram/Twitter/X: use Share on mobile, or download then upload in-app.<br>
          â€¢ Some desktop browsers donâ€™t support Share/Copy for images yetâ€”weâ€™ll fall back gracefully.
        </div>
      </div>
    </div>

    <footer>
      Made for someone special J.M ğŸ’– <br>
      ğŸ“§ <a href="mailto:nicolasnguyenoutlook@gmail.com">nicolasnguyenoutlook@gmail.com</a>
    </footer>
  </div>

  <!-- App JS -->
  <script src="script.js"></script>
</body>
</html>
